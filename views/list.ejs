<!doctype html>

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <!-- Bootstrap CSS -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
    integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
  <link rel="stylesheet" href="/public/main.css">

  <title>Hworld!</title>
</head>

<body>

<div class="container mt-4 text-center">
  <div class="mb-4">


      <input type="text" placeholder="검색" id="keyword">
      <button id="search">검색</button>
  </div>



    <ul class="list-group">
      <% for(var i = 0 ; i< posts.length ; i ++){ %>
      <li class=" list-group-item">
        <div>
          글번호 <%= posts[i]._id %>
        </div>
        <div>
          title : <%= posts[i].title %>
        </div>
        <div>
        </div>
        <button class="button btn btn-danger" data-id=" <%= posts[i]._id %>">삭제</button>
        <a class="btn btn-primary" href="http://localhost:8080/detail/<%= posts[i]._id %>">페이지 이동</a>

        <a class="btn btn-dark" href="http://localhost:8080/edit/<%= posts[i]._id %>">페이지 수정</a>
      </li>
      <% } %>


    </ul>

  </div>


  <script src="https://code.jquery.com/jquery-3.4.1.min.js">
  </script>

  <script>
    // object 들어감
    // delete 요청 들어옴
    //요청시 데이터 들어오는것

    $('.button').click(function (e) {

      let num = e.target.dataset.id
      let thisClick = $(this)
      $.ajax({
        method: "DELETE",
        url: '/delete',
        data: {
          _id: num
        }
      }).done(function (result) {
        // ajax 요청 성공
        thisClick.parent('li').fadeOut()
      }).fail(function (xhr, textStatus, errorThrown) {
        console.log('전송실패');
        console.log(xhr, textStatus, errorThrown);

      })
    })


    $('#search').click(function(){
      let getKeyword = $('#keyword').val();
      window.location.replace('/search?value=' + getKeyword)
    });



  </script>

  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
    integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
    integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
  </script>
</body>

</html>



